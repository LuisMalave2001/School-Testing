<?xml version="1.0" encoding="UTF-8" ?>
<odoo>

  <record model="ir.actions.act_window" id="action_school_students">
    <field name="name">Students</field>
    <field name="res_model">school.student</field>
    <field name="view_mode">kanban,tree,form</field>
    <field name="context">{'lineal_name': True}</field>
  </record>

  <menuitem
    id="menu_students" name="Students"
    parent="school.people_management"
    sequence="1"
    action="action_school_students"/>

  <record id="school_student_view_form" model="ir.ui.view">
    <field name="name">school.student.view.form</field>
    <field name="model">school.student</field>
    <field name="arch" type="xml">
      <form>
        <field name="id" invisible="1"/>
        <header></header>
        <sheet>
          <!-- Field -->
          <field name="id" invisible="1"/>
          <field name="partner_name" invisible="1" force_save="1"/>
          <field name="family_individual_ids" invisible="1"/>

          <h1 style="font-size: xx-large; color: #875A7B; font-weight: bold;" class="mt0 mb0">
            Student
          </h1>
          <field name="image_1920" widget='image' class="oe_avatar" options='{"preview_image": "image_128"}'/>
          <div class="oe_title">
            <h1>
              <field name="name" placeholder="Name" readonly="1" force_save="1"/>
            </h1>
            <group col="3">
              <label for="first_name" colspan="1"/>
              <label for="middle_name" colspan="1"/>
              <label for="last_name" colspan="1"/>

              <field name="first_name" nolabel="1" colspan="1"/>
              <field name="middle_name" nolabel="1" colspan="1"/>
              <field name="last_name" nolabel="1" colspan="1"/>
            </group>
          </div>
          <group>
            <group name="group_left">
              <field name="families_home_address_ids" invisible="1"/>
              <field name="home_address_id"
                     context="{'lineal_name': True}"
                     domain="[('id', 'in', families_home_address_ids)]"/>
              <label for="" name="address_name"><b>Address</b></label>
              <div class="o_address_format">
                <field name="street" placeholder="Street..." class="o_address_street"
                       attrs="{'readonly': [('home_address_id', '!=', False)]}"/>
                <field name="street2" placeholder="Street 2..." class="o_address_street"
                       attrs="{'readonly': [('home_address_id', '!=', False)]}"/>
                <field name="city" placeholder="City" class="o_address_city"
                       attrs="{'readonly': [('home_address_id', '!=', False)]}"/>
                <field name="state_id" class="o_address_state" placeholder="State"
                       attrs="{'readonly': [('home_address_id', '!=', False)]}"
                       options="{&quot;no_open&quot;: True}" context="{'country_id': country_id, 'zip': zip}"/>
                <field name="zip" placeholder="ZIP" class="o_address_zip"
                       attrs="{'readonly': [('home_address_id', '!=', False)]}"/>
                <field name="country_id" placeholder="Country"
                       attrs="{'readonly': [('home_address_id', '!=', False)]}"
                       class="o_address_country" options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}"/>
              </div>
            </group>
            <group name="group_right">
              <!-- <field name="login" invisible="1" force_save="1"/> -->
            </group>
          </group>
          <notebook name="main_notebook">
            <page name="families" string="Families">
              <field name="family_ids" context="{'default_student_ids': [id]}">
                <kanban>
                  <field name="name"/>
                  <templates>
                    <t t-name="kanban-box">
                      <div class="o_kanban_card oe_kanban_global_click p-4">
                        <button style="pointer-events:auto; top:1rem; right:1rem; position:absolute;"
                                class="btn btn-primary"
                                title="open" type="object" name="open_family">
                          <i class="fa fa-share-square-o"/>
                        </button>
                        <div class="oe_kanban_content">
                          <strong><field name="name"/></strong>
                        </div>
                      </div>
                    </t>
                  </templates>
                </kanban>
              </field>
            </page>

            <page name="relationships" string="Relationships">
              <notebook name="relationship_notebook">
                <page name="parents" string="Parents/Guardian">
                  <field name="parent_relationship_ids"
                         context="{'default_individual_id': id}">
                    <tree editable="bottom">
                      <field name="family_id" domain="[('id', 'in', parent.family_ids)]"/>
                      <field name="family_individual_ids" invisible="1"/>
                      <field name="individual_relation_id"
                             domain="[('id', 'in', family_individual_ids), ('id', '!=', parent.id)]"/>
                      <field name="relationship_type_id"/>
                      <field name="custody"/>
                      <field name="correspondence"/>
                      <field name="grade_related"/>
                      <field name="family_portal"/>
                      <field name="is_emergency_contact"/>
                      <field name="financial_responsability"/>
                    </tree>
                  </field>
                </page>
                <page name="siblings" string="Siblings">
                  <field name="sibling_relationship_ids"
                         context="{'default_individual_id': id}">
                    <tree editable="bottom">
                      <field name="family_id" domain="[('id', 'in', parent.family_ids)]"/>
                      <field name="family_individual_ids" invisible="1"/>
                      <field name="individual_relation_id"
                             domain="[('id', 'in', family_individual_ids), ('id', '!=', parent.id)]"/>
                      <field name="relationship_type_id"/>
                      <field name="custody"/>
                      <field name="correspondence"/>
                      <field name="grade_related"/>
                      <field name="family_portal"/>
                      <field name="is_emergency_contact"/>
                      <field name="financial_responsability"/>
                    </tree>
                  </field>
                </page>
                <page name="others" string="Others">
                  <field name="other_relationship_ids"
                         context="{'default_individual_id': id}">
                    <tree editable="bottom">
                      <field name="family_id" domain="[('id', 'in', parent.family_ids)]"/>
                      <field name="family_individual_ids" invisible="1"/>
                      <field name="individual_relation_id"
                             domain="[('id', 'in', family_individual_ids), ('id', '!=', parent.id)]"/>
                      <field name="relationship_type_id"/>
                      <field name="custody"/>
                      <field name="correspondence"/>
                      <field name="grade_related"/>
                      <field name="family_portal"/>
                      <field name="is_emergency_contact"/>
                      <field name="financial_responsability"/>
                    </tree>
                  </field>
                </page>
                <page name="custiodial_rights" string="Custodials">
                  <field name="custodial_relationship_ids" mode="kanban"/>
                </page>
              </notebook>
            </page>

            <page name="healthcare" string="Healthcare">
              <group>
                <group name="group_left">
                  <field name="doctor_name"/>
                  <field name="doctor_phone"/>
                  <field name="doctor_address"/>
                  <separator colspan="2"/>
                  <field name="permission_to_treat"/>
                  <field name="blood_type"/>
                </group>
                <group name="group_right">
                  <field name="hospital"/>
                  <field name="hospital_address"/>
                </group>
                <separator colspan="2"/>
                <group colspan="2">
                  <field name="conditions_ids"/>
                  <field name="allergies_ids"/>
                  <field name="medications_ids"/>
                </group>
              </group>
            </page>

            <page name="academics" string="Academics">
              <group col="6">
                <field name="program_ids" widget="many2many_tags"/>
                <field name="school_ids" widget="many2many_tags"/>
                <field name="grade_level_ids" widget="many2many_tags"/>
              </group>

              <field name="program_setting_ids" context="{'default_student_id': id}">
                <tree editable="bottom">
                  <field name="student_id" invisible="1"/>

                  <field name="school_id"/>
                  <field name="program_id" domain="[('school_id', '=', school_id)]"
                         context="{'default_school_id': school_id}"/>
                  <field name="grade_level_id" domain="[('program_id', '=', program_id)]"
                         context="{'default_program_id': program_id}"/>
                </tree>
              </field>

            </page>
            <page name="enrollment_history" string="Enrollment history">
              <field name="enrollment_history_ids">
                <tree editable="top">
                  <field name="school_id"/>
                  <field name="program_id" domain="[('school_id', '=', school_id)]"/>
                  <field name="grade_level_id" domain="[('program_id', '=', program_id)]"/>
                  <field name="enrollment_status_id"/>
                  <field name="enrollment_sub_status_id"/>
                  <field name="date"/>
                  <field name="note"/>
                </tree>
              </field>
            </page>
            <page name="other" string="Other">

            </page>
          </notebook>
        </sheet>
        <div class="oe_chatter" modifiers="{}">
          <field name="message_follower_ids" widget="mail_followers"/>
          <field name="activity_ids" widget="mail_activity"/>
          <field name="message_ids" widget="mail_thread" options="{'post_refresh': 'recipients'}"/>
        </div>
      </form>
    </field>
  </record>

  <record id="school_student_view_kanban" model="ir.ui.view">
    <field name="name">school.student.view.kanban</field>
    <field name="model">school.student</field>
    <field name="arch" type="xml">
      <kanban>
        <field name="id"/>
        <templates>
          <t t-name="kanban-box">
            <div class="oe_kanban_global_click o_kanban_record_has_image_fill">
              <field name="image_128" widget="image" class="o_kanban_image_fill_left"
                     options="{'zoom': true, 'zoom_delay': 1000, 'background': true, 'preventClicks': false}"/>
              <div class="oe_kanban_details">
                <div class="o_kanban_record_top">
                  <div class="o_kanban_record_headings">
                    <div class="o_kanban_record_title">
                      <field name="name"/>
                    </div>
<!--                    <div class="o_kanban_record_subtitle">subtitle</div>-->
                  </div>
                  <div class="o_dropdown_kanban dropdown">
                    <a role="button" class="dropdown-toogle o-no-caret btn" data-toggle="dropdown" data-display="static"
                       href="#" aria-label="Dropdown menu" title="Dropdown menu">
                      <span class="fa fa-ellipsis-v"/>
                    </a>
                    <div class="dropdown-menu" role="menu">
                      <a role="menuitem" type="edit" class="dropdown-item">Edit</a>
                      <a role="menuitem" type="delete" class="dropdown-item">Delete</a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </t>
        </templates>
      </kanban>
    </field>
  </record>

</odoo>
